/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function e(){var n,r,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",c=i.toStringTag||"@@toStringTag";function a(e,i,o,c){var a=i&&i.prototype instanceof s?i:s,l=Object.create(a.prototype);return t(l,"_invoke",function(e,t,i){var o,c,a,s=0,l=i||[],d=!1,f={p:0,n:0,v:n,a:h,f:h.bind(n,4),d:function(e,t){return o=e,c=0,a=n,f.n=t,u}};function h(e,t){for(c=e,a=t,r=0;!d&&s&&!i&&r<l.length;r++){var i,o=l[r],h=f.p,m=o[2];e>3?(i=m===t)&&(a=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=n):o[0]<=h&&((i=e<2&&h<o[1])?(c=0,f.v=t,f.n=o[1]):h<m&&(i=e<3||o[0]>t||t>m)&&(o[4]=e,o[5]=t,f.n=m,c=0))}if(i||e>1)return u;throw d=!0,t}return function(i,l,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,m),c=l,a=m;(r=c<2?n:a)||!d;){o||(c?c<3?(c>1&&(f.n=-1),h(c,a)):f.n=a:f.v=a);try{if(s=2,o){if(c||(i="next"),r=o[i]){if(!(r=r.call(o,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=o.return)&&r.call(o),c<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=n}else if((r=(d=f.n<0)?a:e.call(t,f))!==u)break}catch(e){o=n,c=1,a=e}finally{s=1}}return{value:r,done:d}}}(e,o,c),!0),l}var u={};function s(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),h=d.prototype=s.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,c,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=d,t(h,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,c,"GeneratorFunction"),t(h),t(h,c,"Generator"),t(h,o,function(){return this}),t(h,"toString",function(){return"[object Generator]"}),(e=function(){return{w:a,m:m}})()}function t(e,n,r,i){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,i){function c(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!i,configurable:!i,writable:!i}):e[n]=r:(c("next",0),c("throw",1),c("return",2))},t(e,n,r,i)}function n(e,t,n,r,i,o,c){try{var a=e[o](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){var c=e.apply(t,r);function a(e){n(c,i,o,a,u,"next",e)}function u(e){n(c,i,o,a,u,"throw",e)}a(void 0)})}}var i=null,o=JSON.parse(localStorage.getItem("pinnedSheets")||"[]");function c(t,n,c,a,u){if((!a||t.visibility===Excel.SheetVisibility.hidden)&&(a||c||t.visibility!==Excel.SheetVisibility.hidden)){var s=document.createElement("button");s.textContent=t.visibility===Excel.SheetVisibility.hidden?"ðŸ‘» ".concat(t.name):t.name,s.className="sheet-btn",o.includes(t.name)&&s.classList.add("pinned"),t.name===n.name&&s.classList.add("active"),t.visibility===Excel.SheetVisibility.hidden&&s.classList.add("hidden"),t.tabColor?s.style.borderLeft="6px solid ".concat(t.tabColor):s.style.borderLeft="6px solid transparent",s.onclick=r(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:if(t.visibility!==Excel.SheetVisibility.hidden){n.n=3;break}if(!confirm('"'.concat(t.name,'" is hidden. Unhide it?'))){n.n=2;break}return n.n=1,Excel.run(function(){var n=r(e().m(function n(r){var i;return e().w(function(e){for(;;)switch(e.n){case 0:return(i=r.workbook.worksheets.getItem(t.name)).visibility=Excel.SheetVisibility.visible,i.activate(),e.n=1,r.sync();case 1:return e.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}());case 1:return n.n=2,listSheets();case 2:n.n=5;break;case 3:return n.n=4,Excel.run(function(){var n=r(e().m(function n(r){return e().w(function(e){for(;;)switch(e.n){case 0:return r.workbook.worksheets.getItem(t.name).activate(),e.n=1,r.sync();case 1:return e.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}());case 4:return n.n=5,listSheets();case 5:return n.a(2)}},n)})),s.oncontextmenu=function(e){e.preventDefault(),i=t.name;var n=document.getElementById("context-menu");n.style.display="block",n.style.top=e.clientY+"px",n.style.left=e.clientX+"px"},u.appendChild(s)}}Office.onReady(function(){Excel.run(function(){var t=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets,e.n=1,listSheets();case 1:return r.onAdded.add(function(){return listSheets()}),r.onDeleted.add(function(){return listSheets()}),r.onNameChanged.add(function(){return listSheets()}),e.n=2,n.sync();case 2:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),"true"===localStorage.getItem("darkMode")&&(document.body.classList.add("dark-mode"),document.getElementById("dark-mode-toggle").checked=!0)}),window.toggleDarkMode=function(){document.body.classList.toggle("dark-mode"),localStorage.setItem("darkMode",document.body.classList.contains("dark-mode"))},window.listSheets=r(e().m(function t(){return e().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Excel.run(function(){var t=r(e().m(function t(n){var r,i,a,u,s,l,d,f,h,m,y;return e().w(function(e){for(;;)switch(e.n){case 0:return a=null===(r=document.getElementById("show-hidden"))||void 0===r?void 0:r.checked,u=null===(i=document.getElementById("only-hidden"))||void 0===i?void 0:i.checked,(s=n.workbook.worksheets).load("items/name,items/visibility,items/tabColor"),(l=n.workbook.worksheets.getActiveWorksheet()).load("name"),e.n=1,n.sync();case 1:(d=document.getElementById("sheet-list")).innerHTML="",f=s.items.filter(function(e){return o.includes(e.name)}),h=s.items.filter(function(e){return!o.includes(e.name)}),f.length>0&&((m=document.createElement("div")).textContent="Pinned Sheets",m.className="section-header",d.appendChild(m),f.forEach(function(e){return c(e,l,a,u,d)})),h.length>0&&((y=document.createElement("div")).textContent="All Sheets",y.className="section-header",d.appendChild(y),h.forEach(function(e){return c(e,l,a,u,d)}));case 2:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),window.filterSheets=function(){var e=document.getElementById("sheet-search").value.toLowerCase();document.querySelectorAll("#sheet-list .sheet-btn").forEach(function(t){t.style.display=t.textContent.toLowerCase().includes(e)?"block":"none"})},window.contextAction=function(){var t=r(e().m(function t(n){return e().w(function(t){for(;;)switch(t.n){case 0:if(i){t.n=1;break}return t.a(2);case 1:return t.n=2,Excel.run(function(){var t=r(e().m(function t(r){var c,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(c=r.workbook.worksheets.getItem(i)).load("name, visibility"),e.n=1,r.sync();case 1:e.n=3;break;case 2:return e.p=2,e.v,console.warn("Sheet not found:",i),e.a(2);case 3:a=n,e.n="activate"===a?4:"hide"===a?5:"unhide"===a?6:"pin"===a?7:8;break;case 4:return c.activate(),e.a(3,8);case 5:return c.visibility=Excel.SheetVisibility.hidden,e.a(3,8);case 6:return c.visibility=Excel.SheetVisibility.visible,e.a(3,8);case 7:return o.includes(c.name)?o=o.filter(function(e){return e!==c.name}):o.push(c.name),localStorage.setItem("pinnedSheets",JSON.stringify(o)),e.a(3,8);case 8:return e.n=9,r.sync();case 9:return e.a(2)}},t,null,[[0,2]])}));return function(e){return t.apply(this,arguments)}}());case 2:return t.n=3,listSheets();case 3:document.getElementById("context-menu").style.display="none";case 4:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),document.addEventListener("click",function(){document.getElementById("context-menu").style.display="none"})}();
//# sourceMappingURL=taskpane.js.map