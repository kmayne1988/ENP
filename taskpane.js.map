{"version":3,"file":"taskpane.js","mappings":";yBACA,IAAAA,EAAAC,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAAC,EAAAJ,EAAAK,aAAA,yBAAAC,EAAAN,EAAAE,EAAAE,EAAAE,GAAA,IAAAC,EAAAL,GAAAA,EAAAM,qBAAAC,EAAAP,EAAAO,EAAAC,EAAAC,OAAAC,OAAAL,EAAAC,WAAA,OAAAK,EAAAH,EAAA,mBAAAV,EAAAE,EAAAE,GAAA,IAAAE,EAAAC,EAAAG,EAAAI,EAAA,EAAAC,EAAAX,GAAA,GAAAY,GAAA,EAAAC,EAAA,CAAAF,EAAA,EAAAb,EAAA,EAAAgB,EAAApB,EAAAqB,EAAAC,EAAAN,EAAAM,EAAAC,KAAAvB,EAAA,GAAAsB,EAAA,SAAArB,EAAAC,GAAA,OAAAM,EAAAP,EAAAQ,EAAA,EAAAG,EAAAZ,EAAAmB,EAAAf,EAAAF,EAAAmB,CAAA,YAAAC,EAAApB,EAAAE,GAAA,IAAAK,EAAAP,EAAAU,EAAAR,EAAAH,EAAA,GAAAiB,GAAAF,IAAAV,GAAAL,EAAAgB,EAAAO,OAAAvB,IAAA,KAAAK,EAAAE,EAAAS,EAAAhB,GAAAqB,EAAAH,EAAAF,EAAAQ,EAAAjB,EAAA,GAAAN,EAAA,GAAAI,EAAAmB,IAAArB,KAAAQ,EAAAJ,GAAAC,EAAAD,EAAA,OAAAC,EAAA,MAAAD,EAAA,GAAAA,EAAA,GAAAR,GAAAQ,EAAA,IAAAc,KAAAhB,EAAAJ,EAAA,GAAAoB,EAAAd,EAAA,KAAAC,EAAA,EAAAU,EAAAC,EAAAhB,EAAAe,EAAAf,EAAAI,EAAA,IAAAc,EAAAG,IAAAnB,EAAAJ,EAAA,GAAAM,EAAA,GAAAJ,GAAAA,EAAAqB,KAAAjB,EAAA,GAAAN,EAAAM,EAAA,GAAAJ,EAAAe,EAAAf,EAAAqB,EAAAhB,EAAA,OAAAH,GAAAJ,EAAA,SAAAmB,EAAA,MAAAH,GAAA,EAAAd,CAAA,iBAAAE,EAAAW,EAAAQ,GAAA,GAAAT,EAAA,QAAAU,UAAA,oCAAAR,GAAA,IAAAD,GAAAK,EAAAL,EAAAQ,GAAAhB,EAAAQ,EAAAL,EAAAa,GAAAxB,EAAAQ,EAAA,EAAAT,EAAAY,KAAAM,GAAA,CAAAV,IAAAC,EAAAA,EAAA,GAAAA,EAAA,IAAAU,EAAAf,GAAA,GAAAkB,EAAAb,EAAAG,IAAAO,EAAAf,EAAAQ,EAAAO,EAAAC,EAAAR,GAAA,OAAAI,EAAA,EAAAR,EAAA,IAAAC,IAAAH,EAAA,QAAAL,EAAAO,EAAAF,GAAA,MAAAL,EAAAA,EAAA0B,KAAAnB,EAAAI,IAAA,MAAAc,UAAA,wCAAAzB,EAAA2B,KAAA,OAAA3B,EAAAW,EAAAX,EAAA4B,MAAApB,EAAA,IAAAA,EAAA,YAAAA,IAAAR,EAAAO,EAAAsB,SAAA7B,EAAA0B,KAAAnB,GAAAC,EAAA,IAAAG,EAAAc,UAAA,oCAAApB,EAAA,YAAAG,EAAA,GAAAD,EAAAR,CAAA,UAAAC,GAAAiB,EAAAC,EAAAf,EAAA,GAAAQ,EAAAV,EAAAyB,KAAAvB,EAAAe,MAAAE,EAAA,YAAApB,GAAAO,EAAAR,EAAAS,EAAA,EAAAG,EAAAX,CAAA,SAAAe,EAAA,UAAAa,MAAA5B,EAAA2B,KAAAV,EAAA,GAAAhB,EAAAI,EAAAE,IAAA,GAAAI,CAAA,KAAAS,EAAA,YAAAV,IAAA,UAAAoB,IAAA,UAAAC,IAAA,CAAA/B,EAAAY,OAAAoB,eAAA,IAAAxB,EAAA,GAAAL,GAAAH,EAAAA,EAAA,GAAAG,QAAAW,EAAAd,EAAA,GAAAG,EAAA,yBAAAH,GAAAW,EAAAoB,EAAAtB,UAAAC,EAAAD,UAAAG,OAAAC,OAAAL,GAAA,SAAAO,EAAAhB,GAAA,OAAAa,OAAAqB,eAAArB,OAAAqB,eAAAlC,EAAAgC,IAAAhC,EAAAmC,UAAAH,EAAAjB,EAAAf,EAAAM,EAAA,sBAAAN,EAAAU,UAAAG,OAAAC,OAAAF,GAAAZ,CAAA,QAAA+B,EAAArB,UAAAsB,EAAAjB,EAAAH,EAAA,cAAAoB,GAAAjB,EAAAiB,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAArB,EAAAiB,EAAA1B,EAAA,qBAAAS,EAAAH,GAAAG,EAAAH,EAAAN,EAAA,aAAAS,EAAAH,EAAAR,EAAA,yBAAAW,EAAAH,EAAA,oDAAAyB,EAAA,kBAAAC,EAAA9B,EAAA+B,EAAAvB,EAAA,cAAAD,EAAAf,EAAAE,EAAAE,EAAAH,GAAA,IAAAO,EAAAK,OAAA2B,eAAA,IAAAhC,EAAA,gBAAAR,GAAAQ,EAAA,EAAAO,EAAA,SAAAf,EAAAE,EAAAE,EAAAH,GAAA,SAAAK,EAAAJ,EAAAE,GAAAW,EAAAf,EAAAE,EAAA,SAAAF,GAAA,YAAAyC,QAAAvC,EAAAE,EAAAJ,EAAA,GAAAE,EAAAM,EAAAA,EAAAR,EAAAE,EAAA,CAAA2B,MAAAzB,EAAAsC,YAAAzC,EAAA0C,cAAA1C,EAAA2C,UAAA3C,IAAAD,EAAAE,GAAAE,GAAAE,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAAS,EAAAf,EAAAE,EAAAE,EAAAH,EAAA,UAAA4C,EAAAzC,EAAAH,EAAAD,EAAAE,EAAAI,EAAAe,EAAAZ,GAAA,QAAAD,EAAAJ,EAAAiB,GAAAZ,GAAAG,EAAAJ,EAAAqB,KAAA,OAAAzB,GAAA,YAAAJ,EAAAI,EAAA,CAAAI,EAAAoB,KAAA3B,EAAAW,GAAAkC,QAAAC,QAAAnC,GAAAoC,KAAA9C,EAAAI,EAAA,UAAA2C,EAAA7C,GAAA,sBAAAH,EAAA,KAAAD,EAAAkD,UAAA,WAAAJ,QAAA,SAAA5C,EAAAI,GAAA,IAAAe,EAAAjB,EAAA+C,MAAAlD,EAAAD,GAAA,SAAAoD,EAAAhD,GAAAyC,EAAAxB,EAAAnB,EAAAI,EAAA8C,EAAAC,EAAA,OAAAjD,EAAA,UAAAiD,EAAAjD,GAAAyC,EAAAxB,EAAAnB,EAAAI,EAAA8C,EAAAC,EAAA,QAAAjD,EAAA,CAAAgD,OAAA,MADA,IAAIE,EAAmB,KACnBC,EAAeC,KAAKC,MAAMC,aAAaC,QAAQ,iBAAmB,MAyEtE,SAASC,EAAkBC,EAAOC,EAAaC,EAAYC,EAAYC,GACrE,KAAID,GAAcH,EAAMK,aAAeC,MAAMC,gBAAgBC,UACxDL,GAAeD,GAAcF,EAAMK,aAAeC,MAAMC,gBAAgBC,QAA7E,CAEA,IAAMC,EAAMC,SAASC,cAAc,UACnCF,EAAIG,YAAcZ,EAAMK,aAAeC,MAAMC,gBAAgBC,OAAM,MAAAK,OACzDb,EAAMc,MACZd,EAAMc,KAEVL,EAAIM,UAAY,YACZrB,EAAasB,SAAShB,EAAMc,OAAOL,EAAIQ,UAAUC,IAAI,UACrDlB,EAAMc,OAASb,EAAYa,MAAML,EAAIQ,UAAUC,IAAI,UACnDlB,EAAMK,aAAeC,MAAMC,gBAAgBC,QAAQC,EAAIQ,UAAUC,IAAI,UAGrElB,EAAMmB,SACRV,EAAIW,MAAMC,WAAa,aAAHR,OAAgBb,EAAMmB,UAE1CV,EAAIW,MAAMC,WAAa,wBAIzBZ,EAAIa,QAAOlC,EAAAZ,IAAAE,EAAG,SAAA6C,IAAA,OAAA/C,IAAAC,EAAA,SAAA+C,GAAA,cAAAA,EAAAjF,GAAA,UACRyD,EAAMK,aAAeC,MAAMC,gBAAgBC,OAAM,CAAAgB,EAAAjF,EAAA,YAC/CkF,QAAQ,IAADZ,OAAKb,EAAMc,KAAI,4BAA4B,CAAFU,EAAAjF,EAAA,eAAAiF,EAAAjF,EAAA,EAC5C+D,MAAMoB,IAAG,eAAAC,EAAAvC,EAAAZ,IAAAE,EAAC,SAAAkD,EAAOC,GAAG,IAAAC,EAAA,OAAAtD,IAAAC,EAAA,SAAAsD,GAAA,cAAAA,EAAAxF,GAAA,OAGX,OAFPuF,EAAID,EAAIG,SAASC,WAAWnC,QAAQE,EAAMc,OAC9CT,WAAaC,MAAMC,gBAAgB2B,QACrCJ,EAAEK,WAAWJ,EAAAxF,EAAA,EACPsF,EAAIO,OAAM,cAAAL,EAAAvE,EAAA,KAAAoE,EAAA,IACjB,gBAAAS,GAAA,OAAAV,EAAArC,MAAA,KAAAD,UAAA,EALc,IAKb,cAAAmC,EAAAjF,EAAA,EACI+F,aAAY,OAAAd,EAAAjF,EAAA,sBAAAiF,EAAAjF,EAAA,EAGd+D,MAAMoB,IAAG,eAAAa,EAAAnD,EAAAZ,IAAAE,EAAC,SAAA8D,EAAOX,GAAG,OAAArD,IAAAC,EAAA,SAAAgE,GAAA,cAAAA,EAAAlG,GAAA,OAEX,OADHsF,EAAIG,SAASC,WAAWnC,QAAQE,EAAMc,MAC9CqB,WAAWM,EAAAlG,EAAA,EACPsF,EAAIO,OAAM,cAAAK,EAAAjF,EAAA,KAAAgF,EAAA,IACjB,gBAAAE,GAAA,OAAAH,EAAAjD,MAAA,KAAAD,UAAA,EAJc,IAIb,cAAAmC,EAAAjF,EAAA,EACI+F,aAAY,cAAAd,EAAAhE,EAAA,KAAA+D,EAAA,IAKtBd,EAAIkC,cAAgB,SAACC,GACnBA,EAAGC,iBACHpD,EAAmBO,EAAMc,KACzB,IAAMgC,EAAOpC,SAASqC,eAAe,gBACrCD,EAAK1B,MAAM4B,QAAU,QACrBF,EAAK1B,MAAM6B,IAAML,EAAGM,QAAU,KAC9BJ,EAAK1B,MAAM+B,KAAOP,EAAGQ,QAAU,IACjC,EAEAhD,EAAUiD,YAAY5C,EAnDqE,CAoD7F,CA7HA6C,OAAOC,QAAQ,WACbjD,MAAMoB,IAAG,eAAA8B,EAAApE,EAAAZ,IAAAE,EAAC,SAAA+E,EAAOC,GAAO,IAAAC,EAAA,OAAAnF,IAAAC,EAAA,SAAAmF,GAAA,cAAAA,EAAArH,GAAA,OACoB,OAApCoH,EAASD,EAAQ1B,SAASC,WAAU2B,EAAArH,EAAA,EAEpC+F,aAAY,OAK2B,OAF7CqB,EAAOE,QAAQ3C,IAAI,kBAAMoB,YAAY,GACrCqB,EAAOG,UAAU5C,IAAI,kBAAMoB,YAAY,GACvCqB,EAAOI,cAAc7C,IAAI,kBAAMoB,YAAY,GAAEsB,EAAArH,EAAA,EAEvCmH,EAAQtB,OAAM,cAAAwB,EAAApG,EAAA,KAAAiG,EAAA,IACrB,gBAAAO,GAAA,OAAAR,EAAAlE,MAAA,KAAAD,UAAA,EAXQ,IAcgC,SAArCQ,aAAaC,QAAQ,cACvBY,SAASuD,KAAKhD,UAAUC,IAAI,aAC5BR,SAASqC,eAAe,oBAAoBmB,SAAU,EAE1D,GASAC,OAAOC,eAJP,WACE1D,SAASuD,KAAKhD,UAAUoD,OAAO,aAC/BxE,aAAayE,QAAQ,WAAY5D,SAASuD,KAAKhD,UAAUsD,SAAS,aACpE,EAMAJ,OAAO7B,WAAUlD,EAAAZ,IAAAE,EAAG,SAAA8F,IAAA,OAAAhG,IAAAC,EAAA,SAAAgG,GAAA,cAAAA,EAAAlI,GAAA,cAAAkI,EAAAlI,EAAA,EACZ+D,MAAMoB,IAAG,eAAAgD,EAAAtF,EAAAZ,IAAAE,EAAC,SAAAiG,EAAOjB,GAAO,IAAAkB,EAAAC,EAAA3E,EAAAC,EAAAwD,EAAA1D,EAAA6E,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA1G,IAAAC,EAAA,SAAA0G,GAAA,cAAAA,EAAA5I,GAAA,OAOH,OANnB2D,EAAmD,QAAzC0E,EAAGlE,SAASqC,eAAe,sBAAc,IAAA6B,OAAA,EAAtCA,EAAwCV,QACrD/D,EAAmD,QAAzC0E,EAAGnE,SAASqC,eAAe,sBAAc,IAAA8B,OAAA,EAAtCA,EAAwCX,SAErDP,EAASD,EAAQ1B,SAASC,YACzBmD,KAAK,+CACNnF,EAAcyD,EAAQ1B,SAASC,WAAWoD,sBACpCD,KAAK,QAAQD,EAAA5I,EAAA,EACnBmH,EAAQtB,OAAM,QAEd0C,EAAgBpE,SAASqC,eAAe,eAChCuC,UAAY,GAEpBP,EAASpB,EAAO4B,MAAMC,OAAO,SAAC1D,GAAC,OAAKpC,EAAasB,SAASc,EAAEhB,KAAK,GACjEkE,EAAWrB,EAAO4B,MAAMC,OAAO,SAAC1D,GAAC,OAAMpC,EAAasB,SAASc,EAAEhB,KAAK,GAEtEiE,EAAOpH,OAAS,KACZsH,EAAevE,SAASC,cAAc,QAC/BC,YAAc,gBAC3BqE,EAAalE,UAAY,iBACzB+D,EAAczB,YAAY4B,GAC1BF,EAAOU,QAAQ,SAACzF,GAAK,OAAKD,EAAkBC,EAAOC,EAAaC,EAAYC,EAAY2E,EAAc,IAGpGE,EAASrH,OAAS,KACduH,EAAcxE,SAASC,cAAc,QAC/BC,YAAc,aAC1BsE,EAAYnE,UAAY,iBACxB+D,EAAczB,YAAY6B,GAC1BF,EAASS,QAAQ,SAACzF,GAAK,OAAKD,EAAkBC,EAAOC,EAAaC,EAAYC,EAAY2E,EAAc,IACzG,cAAAK,EAAA3H,EAAA,KAAAmH,EAAA,IACF,gBAAAe,GAAA,OAAAhB,EAAApF,MAAA,KAAAD,UAAA,EA/Bc,IA+Bb,cAAAoF,EAAAjH,EAAA,KAAAgH,EAAA,IAiEJL,OAAOwB,aAAe,WACpB,IAAMC,EAAQlF,SAASqC,eAAe,gBAAgB/E,MAAM6H,cAC5CnF,SAASoF,iBAAiB,0BAClCL,QAAQ,SAAChF,GACfA,EAAIW,MAAM4B,QAAUvC,EAAIG,YAAYiF,cAAc7E,SAAS4E,GAAS,QAAU,MAChF,EACF,EAKAzB,OAAO4B,cAAa,eAAAC,EAAA5G,EAAAZ,IAAAE,EAAG,SAAAuH,EAAgBC,GAAM,OAAA1H,IAAAC,EAAA,SAAA0H,GAAA,cAAAA,EAAA5J,GAAA,UACtCkD,EAAkB,CAAF0G,EAAA5J,EAAA,eAAA4J,EAAA3I,EAAA,iBAAA2I,EAAA5J,EAAA,EAEf+D,MAAMoB,IAAG,eAAA0E,EAAAhH,EAAAZ,IAAAE,EAAC,SAAA2H,EAAO3C,GAAO,IAAA1D,EAAAsG,EAAA,OAAA9H,IAAAC,EAAA,SAAA8H,GAAA,cAAAA,EAAAnJ,EAAAmJ,EAAAhK,GAAA,OAIK,OAJLgK,EAAAnJ,EAAA,GAG1B4C,EAAQ0D,EAAQ1B,SAASC,WAAWnC,QAAQL,IACtC2F,KAAK,oBAAoBmB,EAAAhK,EAAA,EACzBmH,EAAQtB,OAAM,OAAAmE,EAAAhK,EAAA,eAE+B,OAF/BgK,EAAAnJ,EAAA,EAAAmJ,EAAAhJ,EAEpBiJ,QAAQC,KAAK,mBAAoBhH,GAAkB8G,EAAA/I,EAAA,UAAA8I,EAI7CJ,EAAMK,EAAAhK,EACP,aADO+J,EACG,EAIV,SAJUA,EAIJ,EAIN,WAJMA,EAIE,EAIR,QAJQA,EAIH,iBAXS,OAAjBtG,EAAMmC,WAAWoE,EAAA/I,EAAA,YAI+B,OAAhDwC,EAAMK,WAAaC,MAAMC,gBAAgBC,OAAO+F,EAAA/I,EAAA,YAIC,OAAjDwC,EAAMK,WAAaC,MAAMC,gBAAgB2B,QAAQqE,EAAA/I,EAAA,YASkB,OAL9DkC,EAAasB,SAAShB,EAAMc,MAG/BpB,EAAeA,EAAa8F,OAAO,SAAC1D,GAAC,OAAKA,IAAM9B,EAAMc,IAAI,GAF1DpB,EAAagH,KAAK1G,EAAMc,MAI1BjB,aAAayE,QAAQ,eAAgB3E,KAAKgH,UAAUjH,IAAe6G,EAAA/I,EAAA,mBAAA+I,EAAAhK,EAAA,EAIjEmH,EAAQtB,OAAM,cAAAmE,EAAA/I,EAAA,KAAA6I,EAAA,iBACrB,gBAAAO,GAAA,OAAAR,EAAA9G,MAAA,KAAAD,UAAA,EAnCc,IAmCb,cAAA8G,EAAA5J,EAAA,EAEI+F,aAAY,OAElB5B,SAASqC,eAAe,gBAAgB3B,MAAM4B,QAAU,OAAO,cAAAmD,EAAA3I,EAAA,KAAAyI,EAAA,IAChE,gBAAAY,GAAA,OAAAb,EAAA1G,MAAA,KAAAD,UAAA,EA3CmB,GAgDpBqB,SAASoG,iBAAiB,QAAS,WACjCpG,SAASqC,eAAe,gBAAgB3B,MAAM4B,QAAU,MAC1D,E","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["let contextSheetName = null;\nlet pinnedSheets = JSON.parse(localStorage.getItem(\"pinnedSheets\") || \"[]\");\n\nOffice.onReady(() => {\n  Excel.run(async (context) => {\n    const sheets = context.workbook.worksheets;\n\n    await listSheets();\n\n    // Auto update on sheet add/delete/rename\n    sheets.onAdded.add(() => listSheets());\n    sheets.onDeleted.add(() => listSheets());\n    sheets.onNameChanged.add(() => listSheets());\n\n    await context.sync();\n  });\n\n  // Restore dark mode if previously set\n  if (localStorage.getItem(\"darkMode\") === \"true\") {\n    document.body.classList.add(\"dark-mode\");\n    document.getElementById(\"dark-mode-toggle\").checked = true;\n  }\n});\n\n//\n// Dark mode toggle\n//\nfunction toggleDarkMode() {\n  document.body.classList.toggle(\"dark-mode\");\n  localStorage.setItem(\"darkMode\", document.body.classList.contains(\"dark-mode\"));\n}\nwindow.toggleDarkMode = toggleDarkMode;\n\n//\n// Main render\n//\nwindow.listSheets = async function () {\n  await Excel.run(async (context) => {\n    const showHidden = document.getElementById(\"show-hidden\")?.checked;\n    const onlyHidden = document.getElementById(\"only-hidden\")?.checked;\n\n    const sheets = context.workbook.worksheets;\n    sheets.load(\"items/name,items/visibility,items/tabColor\");\n    const activeSheet = context.workbook.worksheets.getActiveWorksheet();\n    activeSheet.load(\"name\");\n    await context.sync();\n\n    const listContainer = document.getElementById(\"sheet-list\");\n    listContainer.innerHTML = \"\";\n\n    const pinned = sheets.items.filter((s) => pinnedSheets.includes(s.name));\n    const unpinned = sheets.items.filter((s) => !pinnedSheets.includes(s.name));\n\n    if (pinned.length > 0) {\n      const pinnedHeader = document.createElement(\"div\");\n      pinnedHeader.textContent = \"Pinned Sheets\";\n      pinnedHeader.className = \"section-header\";\n      listContainer.appendChild(pinnedHeader);\n      pinned.forEach((sheet) => renderSheetButton(sheet, activeSheet, showHidden, onlyHidden, listContainer));\n    }\n\n    if (unpinned.length > 0) {\n      const otherHeader = document.createElement(\"div\");\n      otherHeader.textContent = \"All Sheets\";\n      otherHeader.className = \"section-header\";\n      listContainer.appendChild(otherHeader);\n      unpinned.forEach((sheet) => renderSheetButton(sheet, activeSheet, showHidden, onlyHidden, listContainer));\n    }\n  });\n};\n\n//\n// Render one sheet button\n//\nfunction renderSheetButton(sheet, activeSheet, showHidden, onlyHidden, container) {\n  if (onlyHidden && sheet.visibility !== Excel.SheetVisibility.hidden) return;\n  if (!onlyHidden && !showHidden && sheet.visibility === Excel.SheetVisibility.hidden) return;\n\n  const btn = document.createElement(\"button\");\n  btn.textContent = sheet.visibility === Excel.SheetVisibility.hidden\n    ? `👻 ${sheet.name}`\n    : sheet.name;\n\n  btn.className = \"sheet-btn\";\n  if (pinnedSheets.includes(sheet.name)) btn.classList.add(\"pinned\");\n  if (sheet.name === activeSheet.name) btn.classList.add(\"active\");\n  if (sheet.visibility === Excel.SheetVisibility.hidden) btn.classList.add(\"hidden\");\n\n  // Tab color stripe\n  if (sheet.tabColor) {\n    btn.style.borderLeft = `6px solid ${sheet.tabColor}`;\n  } else {\n    btn.style.borderLeft = \"6px solid transparent\";\n  }\n\n  // Left click → activate or unhide+activate\n  btn.onclick = async () => {\n    if (sheet.visibility === Excel.SheetVisibility.hidden) {\n      if (confirm(`\"${sheet.name}\" is hidden. Unhide it?`)) {\n        await Excel.run(async (ctx) => {\n          const s = ctx.workbook.worksheets.getItem(sheet.name);\n          s.visibility = Excel.SheetVisibility.visible;\n          s.activate();\n          await ctx.sync();\n        });\n        await listSheets();\n      }\n    } else {\n      await Excel.run(async (ctx) => {\n        const s = ctx.workbook.worksheets.getItem(sheet.name);\n        s.activate();\n        await ctx.sync();\n      });\n      await listSheets();\n    }\n  };\n\n  // Right click → context menu\n  btn.oncontextmenu = (ev) => {\n    ev.preventDefault();\n    contextSheetName = sheet.name;\n    const menu = document.getElementById(\"context-menu\");\n    menu.style.display = \"block\";\n    menu.style.top = ev.clientY + \"px\";\n    menu.style.left = ev.clientX + \"px\";\n  };\n\n  container.appendChild(btn);\n}\n\n//\n// Search filter\n//\nwindow.filterSheets = function () {\n  const query = document.getElementById(\"sheet-search\").value.toLowerCase();\n  const buttons = document.querySelectorAll(\"#sheet-list .sheet-btn\");\n  buttons.forEach((btn) => {\n    btn.style.display = btn.textContent.toLowerCase().includes(query) ? \"block\" : \"none\";\n  });\n};\n\n//\n// Context menu actions\n//\nwindow.contextAction = async function (action) {\n  if (!contextSheetName) return;\n\n  await Excel.run(async (context) => {\n    let sheet;\n    try {\n      sheet = context.workbook.worksheets.getItem(contextSheetName);\n      sheet.load(\"name, visibility\");\n      await context.sync();\n    } catch {\n      console.warn(\"Sheet not found:\", contextSheetName);\n      return;\n    }\n\n    switch (action) {\n      case \"activate\":\n        sheet.activate();\n        break;\n\n      case \"hide\":\n        sheet.visibility = Excel.SheetVisibility.hidden;\n        break;\n\n      case \"unhide\":\n        sheet.visibility = Excel.SheetVisibility.visible;\n        break;\n\n      case \"pin\":\n        if (!pinnedSheets.includes(sheet.name)) {\n          pinnedSheets.push(sheet.name);\n        } else {\n          pinnedSheets = pinnedSheets.filter((s) => s !== sheet.name);\n        }\n        localStorage.setItem(\"pinnedSheets\", JSON.stringify(pinnedSheets));\n        break;\n    }\n\n    await context.sync();\n  });\n\n  await listSheets();\n\n  document.getElementById(\"context-menu\").style.display = \"none\";\n};\n\n//\n// Hide context menu when clicking elsewhere\n//\ndocument.addEventListener(\"click\", () => {\n  document.getElementById(\"context-menu\").style.display = \"none\";\n});\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","contextSheetName","pinnedSheets","JSON","parse","localStorage","getItem","renderSheetButton","sheet","activeSheet","showHidden","onlyHidden","container","visibility","Excel","SheetVisibility","hidden","btn","document","createElement","textContent","concat","name","className","includes","classList","add","tabColor","style","borderLeft","onclick","_callee6","_context6","confirm","run","_ref5","_callee4","ctx","s","_context4","workbook","worksheets","visible","activate","sync","_x3","listSheets","_ref6","_callee5","_context5","_x4","oncontextmenu","ev","preventDefault","menu","getElementById","display","top","clientY","left","clientX","appendChild","Office","onReady","_ref","_callee","context","sheets","_context","onAdded","onDeleted","onNameChanged","_x","body","checked","window","toggleDarkMode","toggle","setItem","contains","_callee3","_context3","_ref3","_callee2","_document$getElementB","_document$getElementB2","listContainer","pinned","unpinned","pinnedHeader","otherHeader","_context2","load","getActiveWorksheet","innerHTML","items","filter","forEach","_x2","filterSheets","query","toLowerCase","querySelectorAll","contextAction","_ref7","_callee8","action","_context8","_ref8","_callee7","_t2","_context7","console","warn","push","stringify","_x6","_x5","addEventListener"],"sourceRoot":""}